0) Make sure that ingress addon is enabled
> minikube addons enable ingress

1) Create namespace "myapp"
> kubectl create namespace myapp
> kubectl config set-context --current --namespace=myapp

2) Deploy db
> cd postgres
> kubectl apply -f postgres-deployment.yaml

3) Migrate when postgres-pod will be ready
> kubectl apply -f initdb.yaml

4) Deploy api-gateway
> cd ../auth-app
> helm install auth-app ./auth-app-chart --atomic
> kubectl apply -f auth_app_ingress.yaml

5) Deploy app
> cd ../app
> helm install app ./app-chart --atomic
> kubectl apply -f app_ingress.yaml

6) Run tests
> cd ..
> newman run api_gateway_postman_collection.json


If you want to execute collection again, drop users table records:
> kubectl exec --stdin --tty pod/postgres-statefulset-0 -- psql -U myuser myapp
> DELETE FROM users WHERE name IS NOT NULL;